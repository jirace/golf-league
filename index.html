<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Golf League Standings</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Golf League Standings</h1>

  <section id="players-setup">
    <h2>Enter Player Names</h2>
    <div id="player-names"></div>
    <button onclick="initializePlayers()">Start Season</button>
  </section>

  <section id="score-entry" style="display:none;">
    <h2>Enter Scores for New Tournament</h2>
    <label>Tournament Name: <input type="text" id="tournament-name" /></label>
    <label><input type="checkbox" id="is-major" /> Major Tournament</label>
    <div id="score-form"></div>
    <button onclick="addRound()">Add Tournament</button>
  </section>

  <section id="standings" style="display:none;">
    <h2>Current Standings</h2>
    <table>
      <thead>
        <tr>
          <th>Player</th>
          <th>Total Points</th>
          <th>Scores</th>
        </tr>
      </thead>
      <tbody id="standings-body"></tbody>
    </table>
  </section>

  <section id="rounds-log" style="display:none;">
    <h2>Tournament Results</h2>
    <div id="rounds-history"></div>
  </section>

  <script>
    let players = JSON.parse(localStorage.getItem('players')) || [];
    let rounds = JSON.parse(localStorage.getItem('rounds')) || [];

    function saveData() {
      localStorage.setItem('players', JSON.stringify(players));
      localStorage.setItem('rounds', JSON.stringify(rounds));
    }

    function initializePlayers() {
      const inputs = document.querySelectorAll('.player-input');
      players = Array.from(inputs).map(input => ({
        name: input.value.trim() || 'Unnamed',
        totalPoints: 0,
        scores: []
      }));
      document.getElementById('players-setup').style.display = 'none';
      document.getElementById('score-entry').style.display = 'block';
      document.getElementById('standings').style.display = 'block';
      document.getElementById('rounds-log').style.display = 'block';
      updateScoreForm();
      updateStandings();
      updateRoundsLog();
      saveData();
    }

    function updateScoreForm() {
      const container = document.getElementById('score-form');
      container.innerHTML = '';
      players.forEach((player, i) => {
        container.innerHTML += `<label>${player.name}: <input type="number" id="score-${i}" /></label><br />`;
      });
    }

    function addRound() {
      const tournamentName = document.getElementById('tournament-name').value.trim() || `Round ${rounds.length + 1}`;
      const isMajor = document.getElementById('is-major').checked;
      const scores = players.map((_, i) => ({
        index: i,
        score: parseFloat(document.getElementById(`score-${i}`).value) || 0
      }));

      scores.sort((a, b) => a.score - b.score);

      const pointsMap = [4, 3, 2, 1];
      const roundResult = {
        name: tournamentName + (isMajor ? ' (Major)' : ''),
        results: []
      };

      scores.forEach((entry, rank) => {
        const player = players[entry.index];
        let points = pointsMap[rank] || 0;
        if (isMajor && rank === 0) {
          points = Math.round(points * 1.5);
        }
        player.totalPoints += points;
        player.scores.push(entry.score);
        roundResult.results.push({ name: player.name, score: entry.score, points });
      });

      rounds.push(roundResult);

      updateStandings();
      updateScoreForm();
      updateRoundsLog();
      saveData();
      document.getElementById('tournament-name').value = '';
      document.getElementById('is-major').checked = false;
    }

    function updateStandings() {
      const body = document.getElementById('standings-body');
      body.innerHTML = '';
      players
        .sort((a, b) => b.totalPoints - a.totalPoints)
        .forEach(player => {
          body.innerHTML += `
            <tr>
              <td>${player.name}</td>
              <td>${player.totalPoints}</td>
              <td>${player.scores.join(', ')}</td>
            </tr>`;
        });
    }

    function updateRoundsLog() {
      const container = document.getElementById('rounds-history');
      container.innerHTML = '';
      rounds.forEach(round => {
        container.innerHTML += `<h3>${round.name}</h3>`;
        container.innerHTML += '<ul>' +
          round.results.map(r => `<li>${r.name}: ${r.score} (Points: ${r.points})</li>`).join('') +
          '</ul>';
      });
    }

    window.onload = () => {
      const container = document.getElementById('player-names');
      if (players.length === 0) {
        for (let i = 0; i < 4; i++) {
          container.innerHTML += `<label>Player ${i + 1}: <input class="player-input" /></label><br />`;
        }
      } else {
        document.getElementById('players-setup').style.display = 'none';
        document.getElementById('score-entry').style.display = 'block';
        document.getElementById('standings').style.display = 'block';
        document.getElementById('rounds-log').style.display = 'block';
        updateScoreForm();
        updateStandings();
        updateRoundsLog();
      }
    }
  </script>
</body>
</html>
